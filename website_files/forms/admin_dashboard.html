<!doctype html>
<html lang="en">
    <head>
        <title> The Ticket Admin Dashboard </title>
        <!-- Style -->
		<link rel="stylesheet" href="styles.css">
    </head>
    
    <body>
        <h1> Dashboard </h1>
        <!-- The Dashboard -->
        <div>
            <div>
				<div>
					<h2> Tickets Log </h2>
				</div>
            </div>
			<div>
				<?php
				// Database connection
				$connect = mysqli_connect(
					'db',
					'UMBCstudent',
					'bongocat123',
					'main_project_db'
				);

				if (!$connect) {
					die("Database connection failed: " . mysqli_connect_error());
				}

				$query = 'SELECT * FROM ticket';
				$result = mysqli_query($connect, $query);
				
				if(!$result) {
					echo "Error running query: " . mysqli_error($connect);
				}
				elseif (mysqli_num_rows($result) > 0){
					echo "<div>";
					echo "<table>";
					echo "<thead>
						<tr>
							<th> ID </th>
							<th> Confirmations </th>
							<th> Type </th>
							<th> Submitted Date </th>
						</tr>
					</thead><tbody>";

					while ($row = mysqli_fetch_assoc($result)) {
						echo "<tr>
							<td>" . htmlspecialchars($row['t_id']). "</td>
							<td>" . htmlspecialchars($row['confirmation']). "</td>
							<td>" . htmlspecialchars($row['ticket_type']). "</td>
							<td>" . htmlspecialchars($row['submitted']). "</td>
						</tr>";
					}

					echo "</tbody></table></div>";
				}
				else {
					echo "No tickets are found!";
				}

				mysqli_close($connect);
			    ?>
			</div>
        </div>

		<div>
			<div>
				<h4> <a href ="dashboard.html" class="formatlink"> Add a Ticket </a> </h4>
			</div>
		</div>

		        <!-- Image -->
        <img src="pngwing.com(2).png" alt="Wall-E" width="360" height="360"> 
    </body>
</html>