<!doctype html>
<html lang="en">
    <head>
        <title> The Ticket Admin Dashboard </title>
        <!-- Style -->
        <style>
        	h2 {
        	  font-size: 35px;
        	}
        	table, th, td{
        	  text-align: center;
        	  margin: auto;
        	  border: 0.5px solid;
        	}
        	th {
        	  background-color: black;
        	  color: white;
        	  padding: 24px;
        	}
        	td {
        	  background-color: #777;
        	  color: white;
        	  padding: 16px;
        	}
        	.formathead {
        	  color: orange;
        	  font-weight: bold;
        	  text-align: left;
        	  display: flex;
        	  margin: 0 20px;
        	  padding: 0 20px;
        	  font-size: 25px;
        	}
    	</style>
    </head>
    
    <body>
        <h1> Admin Dashboard </h1>
        <!-- The Dashboard -->
        <div>
            <div>
				<h2 class="formathead"> Tickets Log </h2>
            </div>
			<div>
				<?php
				// Database connection
				$connect = mysqli_connect(
					'db',
					'UMBCstudent',
					'bongocat123',
					'main_project_db'
				);

				if (!$connect) {
					die("Database connection failed: " . mysqli_connect_error());
				}

				$query = 'SELECT * FROM ticket';
				$result = mysqli_query($connect, $query);
				
				if(!$result) {
					echo "Error running query: " . mysqli_error($connect);
				}
				elseif (mysqli_num_rows($result) > 0){
					echo "<div>";
					echo "<table>";
					echo "<thead>
						<tr>
							<th> # </th>
							<th> Confirmations </th>
							<th> Type </th>
							<th> Submitted Date </th>
						</tr>
					</thead><tbody>";

					$i = 1;
					while ($row = mysqli_fetch_assoc($result)) {
						echo "<tr>
							<td>" . htmlspecialchars($row['t_id']). "</td>
							<td>" . htmlspecialchars($row['confirmation']). "</td>
							<td>" . htmlspecialchars($row['ticket_type']). "</td>
							<td>" . htmlspecialchars($row['submitted']). "</td>
						</tr>";
						$i++;
					}

					echo "</tbody></table></div>";
				}
				else {
					echo "No tickets are found!";
				}

				mysqli_close($connect);
			    ?>
			</div>
        </div>

		<div>
			<div>
				<a href ="dashboard.html"> Add a Ticket </a>
			</div>
		</div>

		<div>
			<div>
				<a href ="dashboard_delete.html"> Delete a Ticket</a>
			</div>
		</div>

		        <!-- Image -->
        <img src="pngwing.com(2).png" alt="Wall-E" width="300" height="300"> 
    </body>
</html>